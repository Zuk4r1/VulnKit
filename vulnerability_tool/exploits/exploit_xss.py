import requests

def execute(target):
    """
    Prueba de vulnerabilidades de Cross-Site Scripting (XSS).
    """
    print(f"[INFO] Probando XSS en: {target}")
    endpoints = ["/search", "/login", "/feedback"]
    payloads = [
        "<script>alert(1)</script>",
        "'><script>alert('XSS')</script>",
        "<img src=x onerror=alert('XSS')>"
    ]
    vulnerable = False

    for endpoint in endpoints:
        for payload in payloads:
            url = f"http://{target}{endpoint}?q={payload}"
            print(f"[INFO] Probar URL: {url}")
            try:
                response = requests.get(url, timeout=5)
                if payload in response.text:
                    vulnerable = True
                    print(f"[ALERTA] XSS detectado en {url} con payload: {payload}")
            except Exception as e:
                print(f"[ERROR] Error al probar XSS en {url}: {e}")

        # Probar env√≠o de datos en POST
        post_url = f"http://{target}{endpoint}"
        try:
            response = requests.post(post_url, data={"input": payload}, timeout=5)
            if payload in response.text:
                vulnerable = True
                print(f"[ALERTA] XSS detectado en {post_url} con payload: {payload} (POST)")
        except Exception as e:
            print(f"[ERROR] Error al probar XSS en {post_url}: {e}")

    return "Vulnerable a XSS" if vulnerable else "No vulnerable"
