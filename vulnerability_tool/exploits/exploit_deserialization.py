import requests

def execute(target):
    print(f"[INFO] Probando deserializaci贸n insegura en: {target}")
    endpoints = ["/api/upload", "/debug", "/test"]
    payload = b"\xac\xed\x00\x05"  # Magic bytes de Java serialized objects
    vulnerable = False

    for endpoint in endpoints:
        url = f"http://{target}{endpoint}"
        try:
            response = requests.post(url, data=payload, timeout=5)
            if "exception" in response.text.lower() or "stacktrace" in response.text:
                vulnerable = True
                print(f"[ALERTA] Deserializaci贸n insegura detectada en {url}")
        except Exception as e:
            print(f"[ERROR] Error al probar deserializaci贸n en {url}: {e}")
    return "Vulnerable a deserializaci贸n" if vulnerable else "No vulnerable"